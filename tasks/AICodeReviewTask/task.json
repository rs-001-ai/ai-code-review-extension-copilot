{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "623fb557-2517-4331-aeea-e3d986bff9c5",
  "name": "AICodeReview",
  "friendlyName": "AI Code Review (GitHub Copilot)",
  "description": "Automatically review Pull Requests using GitHub Copilot. Analyzes code for security, performance, and best practices.",
  "helpMarkDown": "[Learn More](https://github.com/rs-001-ai/ai-code-review-extension-copilot)",
  "category": "Utility",
  "visibility": ["Build", "Release"],
  "author": "Rachit Singhal",
  "version": {
    "Major": 2,
    "Minor": 0,
    "Patch": 2
  },
  "instanceNameFormat": "AI Code Review (Copilot)",
  "inputs": [
    {
      "name": "githubPat",
      "type": "string",
      "label": "GitHub Personal Access Token",
      "required": true,
      "helpMarkDown": "GitHub PAT with Copilot access permissions. Generate a fine-grained token at https://github.com/settings/tokens with 'Copilot Requests' permission."
    },
    {
      "name": "adoPat",
      "type": "string",
      "label": "Azure DevOps PAT",
      "required": false,
      "helpMarkDown": "Azure DevOps PAT for API access. Leave empty to use System.AccessToken (recommended). Required for Azure DevOps Server (on-prem)."
    },
    {
      "name": "copilotModel",
      "type": "pickList",
      "label": "Copilot Model",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "AI model for review. Leave empty for default (claude-4.5-sonnet). Latest models available via GitHub Models API.",
      "options": {
        "": "Default (claude-4.5-sonnet)",
        "claude-4.5-sonnet": "Claude 4.5 Sonnet (recommended)",
        "claude-4.5-haiku": "Claude 4.5 Haiku (faster)",
        "claude-4.5-opus": "Claude 4.5 Opus (most capable)",
        "gpt-5.2-codex": "GPT-5.2 Codex (best for code)",
        "gpt-5.2": "GPT-5.2",
        "gpt-5.2-mini": "GPT-5.2 Mini (faster)",
        "gemini-2.5-pro": "Gemini 2.5 Pro",
        "llama-4-70b": "Llama 4 70B"
      }
    },
    {
      "name": "maxFiles",
      "type": "string",
      "label": "Max Files to Review",
      "required": false,
      "defaultValue": "50",
      "helpMarkDown": "Maximum number of files to include in the review. Files beyond this limit are skipped."
    },
    {
      "name": "maxLinesPerFile",
      "type": "string",
      "label": "Max Lines per File",
      "required": false,
      "defaultValue": "1000",
      "helpMarkDown": "Files with more lines than this are truncated. Helps stay within model context limits."
    },
    {
      "name": "customPrompt",
      "type": "multiLine",
      "label": "Custom Review Prompt",
      "required": false,
      "helpMarkDown": "Override the default review prompt with custom instructions. Avoid double quotes (\"). Supports markdown formatting.",
      "properties": {
        "rows": "8",
        "resizable": "true"
      }
    },
    {
      "name": "promptFile",
      "type": "filePath",
      "label": "Prompt File Path",
      "required": false,
      "helpMarkDown": "Path to a .txt file containing custom review instructions. Overridden by 'Custom Review Prompt' if both are set."
    },
    {
      "name": "debug",
      "type": "boolean",
      "label": "Enable Debug Logging",
      "required": false,
      "defaultValue": "false",
      "helpMarkDown": "Enable verbose debug output in the pipeline logs."
    },
    {
      "name": "continueOnError",
      "type": "boolean",
      "label": "Continue on Error",
      "required": false,
      "defaultValue": "true",
      "helpMarkDown": "If true, the pipeline will not fail if the review encounters an error. A warning comment will be posted instead."
    }
  ],
  "execution": {
    "Node16": {
      "target": "index.js"
    }
  }
}
